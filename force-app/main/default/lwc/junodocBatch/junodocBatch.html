<template>
    <lightning-card>
        <div onfocus={handleInputFocus} >
      <!--  <div class="slds-text-heading_medium slds-box slds-theme_shade" style="color:black;">Junodoc Batch
            <lightning-helptext content="1. Junodoc Batch is used to send instant documents based on search criteria. 
            2. Select object and click on (+) to add filter conditions 
            3. Click on search records button  
            4. Select records from search result and click on Send Document.
            5. Specify Email Recipients, doc templates and click Send  ">
            </lightning-helptext>
         
        </div> -->
                <!-- Modal/Popup Box LWC starts here -->
            <div class="slds-grid slds-grid_align-spread slds-box slds-theme_shade">
                
                <div class="slds-col slds-text-heading_medium" style="color:black;">Junodoc Batch
                  
                   
                    <lightning-helptext  class="slds-text-heading_medium slds-m-top_medium helptextheading" content="1. Junodoc Batch is used to send instant documents based on search criteria. 
                    2. Select object and click on (+) to add filter conditions 
                    3. Click on search records button  
                    4. Select records from search result and click on Next button.
                    5. Select doc templates and click on Next button 
                    6. Select Post Actions and click on Next 
                    7. Specify Email Recipients, doc templates and click Send
                    8. We can download Individual and multiple documents by clicking on Individual & Consolidated Document(s) button"
                    >
                    </lightning-helptext>
                   
                </div>
                <div class="slds-col">

                </div>
                <div class="slds-col" style="padding-right:15px;">
                    <template if:true={SecondNextScreen}>
                        <template if:true={isPOPupOpen}>
                        <span> 
                          <!--  <button class="slds-button slds-button_neutral" onclick={closePopUp} title="Cancel">Cancel</button>-->
                            <button class="slds-button slds-button_brand" onclick={handleSecondPrevious} title="Previous">Previous</button>
                            <template if:true={isSelectedTemplate}>
                                 <button class="slds-button slds-button_brand" onclick={handleSecondNextScreen} title="Next">Next</button>
                            </template>
                            <template if:false={isSelectedTemplate}>
                                 <lightning-button variant="brand" size="small" onclick={handleSecondNextScreen} label="Next" title="Primary action"  disabled class="slds-m-left_x-small"></lightning-button>
                            </template>
                        </span>
                        </template>
                    </template>
                    <template if:true={ThirdNextScreen}>
                       <span style="padding-right:15px;"><!--   <button class="slds-button slds-button_neutral" onclick={closePopUp} title="Cancel">Cancel</button>-->
                        <button class="slds-button slds-button_brand" onclick={handleThirdPrevious} title="Previous">Previous</button>
                        <button class="slds-button slds-button_brand" onclick={handleThirdNextScreen} title="Next">Next</button>
                        </span>
                    </template>
                    <template if:true={FourthNextScreen}>
                        <template if:false={isSendDoc}>
                            <button class="slds-button slds-button_brand" onclick={handleFourthPrevious} title="Previous">Previous</button>
                            </template>
                            </template>
                </div>
                </div> 
                 <br/>
        <lightning-progress-indicator type="path" current-step={selectedStep}>
            <lightning-progress-step label="Record Selection" onstepfocus={selectStep1} onclick={handleProgress} value="Step1">
            </lightning-progress-step>
            <!-- <lightning-progress-step label="Filter Conditions" onstepfocus={selectStep2} onclick={handleProgress} value="Step2">
            </lightning-progress-step>
            <lightning-progress-step label="Records Result" onstepfocus={selectStep3} onclick={handleProgress} value="Step3">
            </lightning-progress-step> -->
            <lightning-progress-step label="Doc Templates" onstepfocus={selectStep2} onclick={handleProgress} value="Step2">
            </lightning-progress-step>
            <lightning-progress-step label="Post Actions" onstepfocus={selectStep3} onclick={handleProgress} value="Step3">
            </lightning-progress-step>
            <lightning-progress-step label="Email or Download Documents" onstepfocus={selectStep4} onclick={handleProgress} value="Step4">
            </lightning-progress-step>
        </lightning-progress-indicator>
       <!-- <template if:false={FirstNextScreen}> -->
        <template if:false={isPOPupOpen}>
               
           
            <div class="header-item1">
            <label>Select Salesforce Object</label><label style="color:red;">*</label>
                <lightning-input
                    value={ObjectLabel} type="search"                    
                    onchange={handleChange} placeholder="Search here...">                                
                </lightning-input>

                
            
                <template if:true={showSearchObjects}>
                    <div id="listbox-id-11" style="height:80%;position:relative;width:100%;padding:0px; overflow:scroll;"
                    class="slds-dropdown slds-dropdown_length-5 slds-dropdown_fluid"
                    role="listbox">
                        <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                            <template for:each={searchObjectsList} for:item = "rec" for:index="index" >
                                <div  key={rec.value} data-item={rec.value} 
                                onclick={handleSearchOnClick}>
                                    <div class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small">
                                        <span class="slds-media__body">
                                            <span class="slds-truncate" title="All Objects">
                                                <span>{rec.label}</span>
                                            </span>
                                        </span>
                                    </div>
                                </div>    
                            </template>
                        </ul>
                    </div>
                </template>
            </div> 
        
        </template>
   <!-- </template>  --> 
            <!-- Trigger Conditions -->
        <template if:true={showTriggerConditions}> 
    
            <div class="header-item2" >
            <label>Formula for filter conditions</label>
            <lightning-helptext class="helptexts" content="Use left and right parenthesis appropriately in the formula when using more than 2 AND or OR conditions e.g. (1 AND (2 OR 3))"></lightning-helptext>
            <lightning-input data-field="filterConditionsFormula"
                    type="text" 
                    access-key={index} id={index}
                    value={filterConditionsValue}
                    onchange={handleFilterConditionsFormulaOnChange}
                    ></lightning-input>
            </div>
        <div class="header-item3">
            <label>Available for search</label>
            <lightning-combobox name="Available For Search"
                value={AvailableForSearchValue}
                options={AvailableForSearchOptions} onchange={handleAvailableForSearch} >
            </lightning-combobox>
        </div>
    
            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th class="" scope="col" style="width:10%;"> 
                            <div class="slds-truncate">NO</div>
                        </th>
                        <th class="" scope="col" style="width:20%;padding-left:0px">
                            <div class="slds-truncate">FIELD NAME<label style="color:red;">*</label></div>
                        </th>
                        <th class="" scope="col" style="width:20%;padding-left:0px">
                            <div class="slds-truncate">OPERATOR<label style="color:red;">*</label></div>
                        </th>
                        <th class="" scope="col" style="width:30%;padding-left:0px">
                            <div class="slds-truncate">VALUE<label style="color:red;">*</label>
                                <lightning-helptext class="helptextheading" content="Please give null to check empty values,     Please give date format : mm/dd/yyyy">
                                </lightning-helptext>
                            </div>
                        </th>
                        <th class="" scope="col" style="width:10%;padding-left:0px">
                            <div class="slds-truncate" style="position:relative;">ACTION</div>
                        </th>                                                                                   
                    </tr> 
                </thead>
            </table>
        <!--<div style="height:200px;overflow-y: scroll;">-->
            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                <tbody>            
                    <template for:each={TriggerConditionsWrapper} for:item = "rec" for:index="index" >
                        <tr key={ShopifySetConditionKeyIndex} class="slds-hint-parent">
    
                            <td style="width:10%;">   
                                <label  style="position:relative;top:0px;">{rec.RowNumber} </label>
                            </td>
    
                            <td style="width:20%;padding-left:0px">                                                  
                                <lightning-combobox 
                                name="Field" 
                                access-key={index} id={index}
                                options={ObjectFieldsWrapper}
                                onchange={ConditionChangeHandler}
                                value={rec.field} variant="label-hidden"
                                >
                                </lightning-combobox>                                           
    
                            </td>
                            <td style="width:20%;padding-left:0px">                                                        
                                <lightning-combobox 
                                name="Operator" 
                                access-key={index} id={index}
                                options={OperatorOptions}
                                onchange={ConditionChangeHandler}
                                value={rec.Operator} variant="label-hidden"
                                >
                                </lightning-combobox>                                           
                            </td>
                            <td style="width:30%;padding-left:0px">
                                <div style="display:inline-flex;width:100%">   
                                    
                                    <div style="width:75%;">
    
                                        <template if:false={rec.isBoolean}>
                                            <lightning-input name="FieldValue" type="text" 
                                            access-key={index} id={index}
                                            value={rec.fieldValue} onchange={ConditionChangeHandler}  variant="label-hidden"
                                            ></lightning-input>
                                        </template>
    
                                        <template if:true={rec.isBoolean}>
                                            <lightning-combobox 
                                            name="FieldValue" 
                                            access-key={index} id={index}
                                            options={booleanOptions}
                                            onchange={ConditionChangeHandler}
                                            value={rec.fieldValue}     variant="label-hidden"                                                                
                                            >
                                            </lightning-combobox>  
                                        </template>
                                    </div>
    
    
                                    <div style="width:25%;cursor:pointer;margin-right:5px;position:relative;top:0px;text-align:center">
                                        <template if:true={rec.isPicklist}>
                                            <lightning-icon icon-name="standard:search" 
                                            name="searchPicklist"                                                                
                                            access-key={index} id={index} 
                                            onclick={handleSearchPicklistClick}
                                            alternative-text="search" title="search"></lightning-icon>
                                        </template>
                                    </div>
                                </div>
                            </td>
                            <td style="width:10%;padding-left:0px">
                                <lightning-button icon-name="utility:delete" 
                                style="position:relative;top:0px;" access-key={index} id={index} 
                                alternative-text="Delete Row" size="small" title="Delete Row"
                                onclick={removeTriggerConditionRow} >
                                </lightning-button> 
                            </td>
                        </tr>                                       
                    </template>
                </tbody>
            </table>
        <!--</div> -->
            <br>
            <div class="slds-float_right slds-p-bottom_small" style="padding-right:15px;">
                <lightning-button icon-name="utility:add"  size="small" title="Add Row"
                        alternative-text="Add Row" onclick={addTriggerConditionRow}> </lightning-button>&nbsp;&nbsp;
                        <template if:true={isShowRecordsDisable}>
                            &nbsp;&nbsp;<lightning-button  label="Search Result" onclick={handleShowRecords} variant="brand" title="Primary action" disabled class="slds-m-left_x-small"></lightning-button>
                    </template>
                    <template if:false={isShowRecordsDisable}>
                        &nbsp;&nbsp;<lightning-button  label="Search Result" onclick={handleShowRecords} variant="brand"></lightning-button>
                        </template>
                        <template if:true={saveQueryDisable}>
                            &nbsp;&nbsp;<lightning-button  label="Save Criteria" onclick={handleSaveCriteria} variant="brand" title="Primary action" disabled class="slds-m-left_x-small"></lightning-button>
                        </template>
                    
                        <template if:false={saveQueryDisable}>
                        &nbsp;&nbsp;<lightning-button  label="Save Criteria" onclick={handleSaveCriteria} variant="brand" ></lightning-button>
                        </template>
                    
                    
            </div>
    <br/><br/>
 
        <template if:true={openPicklistModal}>
            <!-- Modal/Popup Box LWC starts here -->
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container" style="width:25%;">
                    <!-- Modal/Popup Box LWC header here -->
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closePicklistModal}>
                            <lightning-icon icon-name="utility:close"
                                alternative-text="close"
                                variant="inverse"
                                size="small" ></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-03" class="slds-text-heading_medium slds-hyphenate">
                            Select Values </h2>
                    </header>
                    <!-- Modal/Popup Box LWC body starts here -->
                    <div class="slds-modal__content slds-p-around_medium" 
                    id="modal-content-id-3" style="height:300px;">
    
                        <lightning-checkbox-group name="Checkbox Group"
                        label=''
                        options={pickListValuesList}
                        value={optionValues}
                        onchange={handlePickListValueChange}></lightning-checkbox-group>
            
                    </div>
                    <!-- Modal/Popup Box LWC footer starts here -->
                    <footer class="slds-modal__footer">
                        <lightning-button label="Insert Values" variant="brand" onclick={onclickPicklistInsertValues}></lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>        
    </template>
    <template if:true={FirstNextScreen}>
        <template if:true={showRecords}>   
    <h2 id="modal-heading-02" class="slds-text-heading_medium slds-hyphenate slds-align_absolute-center">Search Result</h2>
   
    <div class="slds-float_right" style="padding-right:15px;">
        <!-- <lightning-button variant="neutral" size="small" onclick={closePopUp} label="Cancel"></lightning-button>
        &nbsp;&nbsp; <lightning-button variant="brand" size="small" onclick={handleFirstPrevious} label="Previous"></lightning-button> -->
        <template if:true={isSendPdfDisable}>
            
            
            &nbsp;&nbsp; <lightning-button variant="brand" size="small" onclick={handleDownloadPDF} label="Next" title="Primary action"  disabled class="slds-m-left_x-small"></lightning-button>
                <!-- &nbsp;&nbsp; <lightning-button  size="small" variant="
                    brand" label="Send Document" onclick={handleVFPage} title="Primary action" disabled class="slds-m-left_x-small"></lightning-button> -->

            </template>
            <template if:false={isSendPdfDisable}>
            
            &nbsp;&nbsp; <lightning-button variant="brand" size="small" onclick={handleDownloadPDF} label="Next" ></lightning-button>
                <!--   &nbsp;&nbsp;<lightning-button variant="brand" size="small" onclick={handleVFPage} label="Send Document" ></lightning-button> -->

            </template>
        </div>
    </template>
        <br/>
    <!-- Modal/Popup Box LWC body starts here -->
<template if:true={showRecords}>
<br/>
<!--<div class="slds-align_absolute-center">

<template if:true={isSendPdfDisable}>
    <br>
        <lightning-button variant="brand" size="small" onclick={handleDownloadPDF} label="Download Document" title="Primary action"  disabled class="slds-m-left_x-small"></lightning-button>
       &nbsp;&nbsp; <lightning-button  size="small" variant="brand" label="Send Document" onclick={handleVFPage} title="Primary action" disabled class="slds-m-left_x-small"></lightning-button>

    </template>
    <template if:false={isSendPdfDisable}>
    <br>
        <lightning-button variant="brand" size="small" onclick={handleDownloadPDF} label="Download Document" ></lightning-button>
        &nbsp;&nbsp;<lightning-button variant="brand" size="small" onclick={handleVFPage} label="Send Document" ></lightning-button>
    </template>
</div><br/> -->
<template if:false={isCaseObject}> 
    <template if:false={isWorkOrderObject}> 
        <lightning-datatable
                key-field="id"
                selected-rows={Selection}
                data={getRecords}
                row-number-offset={rowOffset}
                onrowselection={rowSelection}
                show-row-number-column
                columns={columns}>
        </lightning-datatable>
    </template>
</template>
<template if:true={isCaseObject}>
<lightning-datatable
key-field="id"
selected-rows={Selection}
data={getRecords}
row-number-offset={rowOffset}

onrowselection={rowSelection}
show-row-number-column
columns={CaseColumnsList}>
</lightning-datatable> 
</template> 
<template if:true={isWorkOrderObject}>
    <lightning-datatable
    key-field="id"
    selected-rows={Selection}
    data={getRecords}
    row-number-offset={rowOffset}
    
    onrowselection={rowSelection}
    show-row-number-column
    columns={WorkOrderColumnsList}>
    </lightning-datatable> 
    </template> 
<br>
<div class="slds-align_absolute-center">

   
</div>

</template>
<template if:false={showRecords}>
<br>
&nbsp;&nbsp;&nbsp;<div class="slds-text-heading_medium slds-align_absolute-center">Search Result</div>
<div class="slds-align_absolute-center">No Records Found</div>

</template>
<!--<template if:true={showRecords}>
<div class="slds-float_right" style="padding-right:15px;">
   
    <template if:true={isSendPdfDisable}>
       
       
        &nbsp;&nbsp; <lightning-button variant="brand" size="small" onclick={handleDownloadPDF} label="Next" title="Primary action"  disabled class="slds-m-left_x-small"></lightning-button>

        </template>
        <template if:false={isSendPdfDisable}>
       
        &nbsp;&nbsp; <lightning-button variant="brand" size="small" onclick={handleDownloadPDF} label="Next" ></lightning-button>

        </template>
        <br/>
    </div>
</template>-->
<br/>
</template>
        <br>
        
        <template if:true={openSaveQuery}>
        <!-- Modal/Popup Box LWC starts here -->
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-07" aria-modal="true" aria-describedby="modal-content-id-7" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container" style="width:75%;height:75%">
                <!-- Modal/Popup Box LWC header here -->
                <header class="slds-modal__header">
                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={handleCancel}>
                        <lightning-icon icon-name="utility:close"
                            alternative-text="close"
                            variant="inverse"
                            size="small" ></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <h2 id="modal-heading-07" class="slds-text-heading_medium slds-hyphenate">
                        Save Criteria </h2>
                </header>
                <div class="slds-modal__content slds-p-around_medium" 
                id="modal-content-id-7" style="height:300px;">
                <lightning-input label="Name" type="text" value={AvailableForSearchLabel} onchange={handleBatchName}></lightning-input>
                <lightning-input label="Object" type="text" value={ObjectLabel} disabled></lightning-input>
                </div>
                <footer class="slds-modal__footer">
                    <button class="slds-button slds-button_brand" onclick={handleUpdateQueryToObject} title="Update" disabled={disableupdate}>Update Criteria</button >
                    <button class="slds-button slds-button_brand" onclick={handleSaveQueryToObject} title="Save">Save New Criteria</button >
                    <button class="slds-button slds-button_neutral" onclick={closePopUp} title="Cancel" >Cancel </button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
        </template>     
        <!--Show Records-->
        <p if:false={isLoaded}></p>
        <div if:true={isLoaded} class="slds-align_absolute-center"> 
        <lightning-spinner
            alternative-text="Loading..." variant="brand">
        </lightning-spinner>
        </div> 
      
    
       <!-- <template if:true={isProgressBarVisible}>
        <lightning-progress-indicator type="path" current-step={selectedStep}>
            <lightning-progress-step label="Records Result" onstepfocus={selectStep1} onclick={handleProgress} value="Step1">
            </lightning-progress-step>
            <lightning-progress-step label="Doc Templates" onstepfocus={selectStep2} onclick={handleProgress} value="Step2">
            </lightning-progress-step>
            <lightning-progress-step label="Post Actions" onstepfocus={selectStep3} onclick={handleProgress} value="Step3">
            </lightning-progress-step>
            <lightning-progress-step label="Send & Download Documents" onstepfocus={selectStep4} onclick={handleProgress} value="Step4">
            </lightning-progress-step>
        </lightning-progress-indicator>
        </template> -->
       
    <template if:true={SecondNextScreen}>
        <template if:true={isPOPupOpen}>
            <!-- Modal/Popup Box LWC starts here -->
           <!-- <div class="slds-grid slds-grid_align-spread slds-theme_shade">
                <div class="slds-col">
                </div>
                <div class="slds-col">
                  <span> <h2 id="modal-heading-01" class="slds-text-heading_medium ">Doc Templates</h2></span>
                </div>
                <div class="slds-col" style="padding-right:15px;">
                  <span> <button class="slds-button slds-button_neutral" onclick={closePopUp} title="Cancel">Cancel</button>
                    <button class="slds-button slds-button_brand" onclick={handleSecondPrevious} title="Previous">Previous</button>
                    <template if:true={isSelectedTemplate}>
                        <button class="slds-button slds-button_brand" onclick={handleSecondNextScreen} title="Next">Next</button>
                    </template>
                    <template if:false={isSelectedTemplate}>
                        <lightning-button variant="brand" size="small" onclick={handleSecondNextScreen} label="Next" title="Primary action"  disabled class="slds-m-left_x-small"></lightning-button>
                    </template></span>
                </div>
              </div> -->
            
                       
                        <!-- <button class="slds-button slds-button_brand" onclick={SinglePDFsDownload} title="Download">Individual Documents</button>
                        <button class="slds-button slds-button_brand" onclick={MultiplePDFsDownload} title="Download">Consolidated Document</button> -->
                   
                 

           
            
                
            
                    <!-- Modal/Popup Box LWC body starts here -->
                  
                       <div class="slds-theme--default">
                            <lightning-combobox
                            name="templates"
                            label="Available Doc Templates "
                            value={AvailableDocTemplateSelectedValue}
                            placeholder="Select Doc Template"
                            options={AvailableDocTemplatesList}
                            onchange={AvailableDocTemplateOnchangeHandler} style="padding-left:15px;width:1000px;"></lightning-combobox>
                        </div>
                           
                      <br/>
                        <template if:true={isSelectedTemplate}>
                            <div class="slds-m-around_medium">
                                <iframe width="100%" height="600" src={fullUrl}></iframe>
                            </div>  
                        </template>
                     <!--   <div style="width:100%;max-height:300px; margin:0 auto;">
                            <table>
                                <tr>                               
                                    <td>   
                                        <lightning-button label="Add Row" variant="brand" onclick={addPostTriggerActionRow}></lightning-button> 
                                    </td>
                                </tr>
                            </table>         
                            
                            <div>
                                <label>Set Post Action Values</label>
                                <lightning-helptext content="Please give null to check empty values"></lightning-helptext>
                                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                    <thead>
                                        <tr class="slds-line-height_reset">
                                            <th class="" scope="col">
                                                <div class="slds-truncate">NO</div>
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate">FIELD NAME<label style="color:red;">*</label></div>
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate">VALUE<label style="color:red;">*</label></div>
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate">ACTION</div>
                                            </th>                                                                                   
                                        </tr> 
                                    </thead>
                                </table>
                            </div>

                             
                            <div style="height:200px;overflow-y: scroll;">
                                <table class="slds-table slds-table_cell-buffer slds-table_bordered">                                                                            
                                    <tbody>
                                        <template for:each={PostTriggerActionsWrapper} for:item = "rec1" for:index="index" >
                                            <tr key={PostTriggerActionKeyIndex} class="slds-hint-parent">
                                                <td >
                                                    {rec1.RowNumber}
                                                </td>
                                                <td class="slds-size_2-of-10">
                                                    <div>
                                                    <lightning-combobox 
                                                    name="PostTriggerActionField" 
                                                    access-key={index} id={index}
                                                    options={ObjectFieldsWrapper}
                                                    value={rec1.Field}
                                                    onchange={handlePostTriggerActionOnChange}
                                                    >
                                                    </lightning-combobox></br>
                                                   </div>                                         
                                                </td>                                          
                                                <td class="slds-size_2-of-10">
                                                    <div>
                                                    <lightning-input name="PostTriggerActionValue" type="text" 
                                                    access-key={index} id={index}
                                                    value={rec1.Value} onchange={handlePostTriggerActionOnChange} 
                                                    ></lightning-input><br>
                                                    </div>
                                                </td>
                                                <td class="slds-size_1-of-10">
                                                    <div>
                                                    <lightning-button icon-name="utility:delete"  access-key={index} id={index} 
                                                    alternative-text="Delete Row" size="small" title="Delete Row"
                                                    onclick={removePostTriggerActionRow} >
                                                    </lightning-button>  
                                                </div> 
                                                </td>
                                            </tr>
                                        </template>
                                    </tbody>
                                </table>
                            </div>-->
                           <!--  <lightning-tab label="Post Actions">
                           <c-child-junodoc-btach object={SalesforceObject} selectedrecordids={selectedrecordIds} templateid={TemplateId} postactionwrapper={PostTriggerActionsWrapper} availableforsearchvalue={AvailableForSearchValue}></c-child-junodoc-btach> 
                        </lightning-tab>
                        </lightning-tabset>-->
                       
                        <template if:true={isSelectedTemplate}>
                            <!--   <iframe width="800" height="400" src={fullUrl}></iframe> -->
    
                        </template>
                    
                    <br/>
                    <br/>
                    <!-- Modal/Popup Box LWC footer starts here -->
                    <!--<div class="slds-float_right" style="padding-right:15px;padding-bottom:15px;">
                        <button class="slds-button slds-button_neutral" onclick={closePopUp} title="Cancel">Cancel</button>
                        <button class="slds-button slds-button_brand" onclick={handleSecondPrevious} title="Previous">Previous</button>
                        <template if:true={isSelectedTemplate}>
                            <button class="slds-button slds-button_brand" onclick={handleSecondNextScreen} title="Next">Next</button>
                        </template>
                        <template if:false={isSelectedTemplate}>
                            <lightning-button variant="brand" size="small" onclick={handleSecondNextScreen} label="Next" title="Primary action"  disabled class="slds-m-left_x-small"></lightning-button>
                        </template>
                          </div>-->
                    <br/>
        </template>
    </template>
       
    <template if:true={ThirdNextScreen}>
        <!--<div class="slds-grid slds-grid_align-spread slds-theme_shade">
            <div class="slds-col">
            </div>
            <div class="slds-col">
              <span> <h2 id="modal-heading-04" class="slds-text-heading_medium slds-align_absolute-center" style="padding-left:240px;">Post Actions</h2></span>
            </div>
            <div class="slds-col">
              <span style="padding-right:15px;">  <button class="slds-button slds-button_neutral" onclick={closePopUp} title="Cancel">Cancel</button>
                <button class="slds-button slds-button_brand" onclick={handleThirdPrevious} title="Previous">Previous</button>
                <button class="slds-button slds-button_brand" onclick={handleThirdNextScreen} title="Next">Next</button>
                </span>
            </div>
          </div>-->
          <div style="width:100%;margin:0 auto;">
            <!-- <template if:true={successMessage}>
               <div style="width:100%; border-radius:10px;
                margin:0 auto; padding:10px; position: relative;background:green;
                color:white;text-align:center;">
                {alertMessage}</div>
                </template>
                <template if:true={errorMessage}>
                <div id="divError" style="width:100%; border-radius:10px;
                margin:0 auto; padding:10px; position: relative;background:red;
                color:black;text-align:center;">
                {alertMessage}</div>
                </template> -->
            
            <table>
                <tr>                               
                    <td>  
                        <div class="slds-align_absolute-center"> 
                            <br/><lightning-button label="Add Row" variant="brand" onclick={addPostTriggerActionRow}></lightning-button> 
                        </div>
                    </td>
                </tr>
            </table>         
            
            <div>
                <label>Set Post Action Values</label>
               <!-- <lightning-helptext content="Please give null to check empty values"></lightning-helptext> -->
                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                    <thead>
                        <tr class="slds-line-height_reset">
                            <th class="slds-size_1-of-10" scope="col" style="width:10%">
                                <div class="slds-truncate">NO</div>
                            </th>
                            <th class="slds-size_3-of-10" scope="col" style="width:30%;padding-left:0px">
                                <div class="slds-truncate">FIELD NAME<label style="color:red;">*</label></div>
                            </th>
                            <th class="slds-size_3-of-10" scope="col" style="width:30%;padding-left:0px">
                                <div class="slds-truncate">VALUE<label style="color:red;">*</label> <lightning-helptext class="helptextheading" content="Please give null to check empty values,     Please give date format : mm/dd/yyyy">
                                </lightning-helptext></div>
                            </th>
                            <th class="slds-size_1-of-10" scope="col" style="width:10%;padding-left:0px">

                            </th>
                            <th class="slds-size_1-of-10" scope="col" style="width:20%;padding-left:0px">
                                <div class="slds-truncate">ACTION</div>
                            </th>                                                                                   
                        </tr> 
                    </thead>
                </table>
            </div>
    
             
            <div style="height:500px;overflow-y: scroll;">
                <table class="slds-table slds-table_cell-buffer slds-table_bordered">                                                                            
                    <tbody>
                        <template for:each={PostTriggerActionsWrapper} for:item = "rec1" for:index="index" >
                            <tr key={PostTriggerActionKeyIndex} class="slds-hint-parent">
                                <td class="slds-size_1-of-10" style="width:10%">
                                    {rec1.RowNumber}
                                </td>
                                <td class="slds-size_3-of-10" style="width:30%;padding-left:0px">
                                    <div>
                                    <lightning-combobox 
                                    name="PostTriggerActionField" 
                                    access-key={index} id={index}
                                    options={ObjectFieldsWrapper}
                                    value={rec1.Field}
                                    onchange={handlePostTriggerActionOnChange}
                                    >
                                    </lightning-combobox></br>
                                   </div>                                         
                                </td>                                          
                                <td class="slds-size_3-of-10" style="width:30%;padding-left:0px">
                                    <div>
                                    <lightning-input name="PostTriggerActionValue" type="text" 
                                    access-key={index} id={index}
                                    value={rec1.Value} onchange={handlePostTriggerActionOnChange} 
                                    ></lightning-input><br>
                                    </div>
                                </td>
                                <td class="slds-size_1-of-10" style="width:10%;">
                                        <template if:true={rec1.isPicklist}>
                                            <lightning-icon icon-name="standard:search" 
                                            name="searchPicklist"                                                                
                                            access-key={index} id={index} 
                                            onclick={handlePicklistClick}
                                            alternative-text="search" title="search"></lightning-icon>
                                        </template>
                                </td>
                                <td class="slds-size_1-of-10" style="width:20%;">
                                    <div>
                                    <lightning-button icon-name="utility:delete"  access-key={index} id={index} 
                                    alternative-text="Delete Row" size="small" title="Delete Row"
                                    onclick={removePostTriggerActionRow} >
                                    </lightning-button>  
                                </div> 
                                </td>
                               
                            </tr>
                        </template>
                    </tbody>
                </table>
                <div class="slds-align_absolute-center" style="margin-top:10px">
                    <lightning-button 
                    alternative-text="Save" size="small" title="Save Actions" label="Save Actions"
                    variant="brand" onclick={handleSaveActions}>
                    </lightning-button>
                </div>
            </div>
        </div>
       
          <!--<c-child-junodoc-btach data-id="childJuno" object={SalesforceObject} selectedrecordids={selectedrecordIds} templateid={TemplateId} postactionwrapper={PostTriggerActionsWrapper} availableforsearchvalue={AvailableForSearchValue}></c-child-junodoc-btach> 
       
       <c-child-junodoc-btach object={SalesforceObject} selectedrecordids={selectedrecordIds} templateid={TemplateId} postactionwrapper={PostTriggerActionsWrapper} availableforsearchvalue={AvailableForSearchValue}></c-child-junodoc-btach> -->
        <br/>
        <!--<div class="slds-float_right" style="padding-right:15px;padding-bottom:15px;">
            <button class="slds-button slds-button_neutral" onclick={closePopUp} title="Cancel">Cancel</button>
            <button class="slds-button slds-button_brand" onclick={handleThirdPrevious} title="Previous">Previous</button>
            <button class="slds-button slds-button_brand" onclick={handleThirdNextScreen} title="Next">Next</button>
            </div>-->
        <br/>
    </template>
    <template if:true={openPicklist}>
        <!-- Modal/Popup Box LWC starts here -->
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container" style="width:25%;">
                <!-- Modal/Popup Box LWC header here -->
                <header class="slds-modal__header">
                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closePicklistModal}>
                        <lightning-icon icon-name="utility:close"
                            alternative-text="close"
                            variant="inverse"
                            size="small" ></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <h2 id="modal-heading-04" class="slds-text-heading_medium slds-hyphenate">
                        Select Values </h2>
                </header>
                <!-- Modal/Popup Box LWC body starts here -->
                <div class="slds-modal__content slds-p-around_medium" 
                id="modal-content-id-4" style="height:300px;">

                    <lightning-radio-group name="Checkbox Group"
                    label=''
                    options={pickListValuesList}
                    
                    value={picklistVal}
                    onchange={posthandlePickListValueChange}></lightning-radio-group>
        
                </div>
                <!-- Modal/Popup Box LWC footer starts here -->
                <footer class="slds-modal__footer">
                    <lightning-button label="Insert Values" variant="brand" onclick={PicklistInsertValues}></lightning-button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template> 
       <template if:true={FourthNextScreen}>
        <template if:false={isSendDoc}>
        <h2 id="modal-heading-05" class="slds-text-heading_medium slds-align_absolute-center">Email or Download Documents</h2><br/>
           <br/>
          <template if:false={showProgress}>
            <div class="slds-align_absolute-center">
                
                    
                    <button class="slds-button slds-button_brand" onclick={SinglePDFsDownload} title="Download">Individual Documents</button>
                    <button class="slds-button slds-button_brand" onclick={MultiplePDFsDownload} title="Download">Consolidated Document</button>
                    <button class="slds-button slds-button_brand" onclick={handleVFPage} title="Send Document">Send Document</button>
                
            </div>
            </template>
            <template if:true={showProgress}>
                    <lightning-layout multiple-rows="true" >
                        <lightning-layout-item size="12" large-device-size="2" medium-device-size="2" small-device-size = "12">
                            
                        </lightning-layout-item>
                        <lightning-layout-item size="12" large-device-size="8" medium-device-size="8" small-device-size = "12">
                            <div>
                                    <lightning-progress-bar value={progressValue} size="large" variant="circular"></lightning-progress-bar>
                                </div>
                                        
                            <div><p>Processed Records: {processingRecords} out of {TotalRecords}</p></div>
                        </lightning-layout-item>
                        <lightning-layout-item size="12" large-device-size="2" medium-device-size="2" small-device-size = "12">
                            
                        </lightning-layout-item>
                    </lightning-layout>
                </template>
            </template>
            <template if:true={isSendDoc}>
                <div class="slds-modal__content slds-p-around_medium">
                        <lightning-accordion class="example-accordion" active-section-name={activeSections}
                                                            onsectiontoggle={handleToggleSection}
                                                            allow-multiple-sections-open>
                            <lightning-accordion-section name="A" label="Select Email Addresses">
                                <c-junodoc-lwc-add-email-recipient 
                                email-recipients={addEmailRecipientsList}
                                object-name={SalesforceObject}
                                object-label={SalesforceObject}
                                onaddemailrecipientsave={hanldeAddEmailRecipientSave}
                                ></c-junodoc-lwc-add-email-recipient>
                            </lightning-accordion-section>
                        </lightning-accordion>  
                        <lightning-accordion class="example-accordion" active-section-name={activeSections}
                                                    onsectiontoggle={handleToggleSection}
                                                    allow-multiple-sections-open>
                                                <lightning-accordion-section name="B" label="Select From Email Address">
                                                    <table>
                                                        <tbody>
                                                            <tr>
                                                                <td style="width:180px;">
                                                                    From Email Address:
                                                                    <lightning-helptext content="Please Enter From Email Address [specify org wide email address only]"></lightning-helptext>
                                                                </td>
                                                                <td>                                                                    
                                                                    <lightning-combobox 
                                                                    name="FromEmailAddress" 
                                                                    options={OrgwideEmailAddressList}
                                                                    value={FromEmailAddress}
                                                                    onchange={handleFromEmailAddressOnChange} 
                                                                    >
                                                                    </lightning-combobox>                                            
                                                                </td>
                                                            </tr> 
                                                            <tr>
                                                                <td style="width:180px;">
                                                                     Set Reply To:
                                                                     <lightning-helptext content="Please Enter Email Address to set as reply to"></lightning-helptext>
                                                                </td>                                    
                                                                <td>
                                                                    <lightning-input 
                                                                    data-field="SetReplyTo"
                                                                    type="text" 
                                                                    value={SetReplyTo}
                                                                    onchange={handleSetReplyToOnChange}
                                                                    ></lightning-input>                                            
                                                                </td>
                                                            </tr> 
                                                        </tbody>
                                                    </table>       
                                                </lightning-accordion-section>
                                            </lightning-accordion>  
                                            <lightning-accordion class="example-accordion" active-section-name={activeSections}
                                            onsectiontoggle={handleToggleSection}
                                            allow-multiple-sections-open>
                                        <lightning-accordion-section name="C" label="Select Templates">
                                            <table>
                                                <tbody>
                                                <tr style="height: 10px;"></tr>
                                             
                                                <tr style="height: 10px;"></tr>
                                                <tr>
                                                    <td style="width:180px;">
                                                        Standard Email Template:
                                                        <lightning-helptext content="Please Select Email Template"></lightning-helptext>
                                                    </td>
                                                    <td >
                                                        <lightning-combobox 
                                                        name="StandardEmailTemplates" 
                                                        options={StandardEmailTemplatesList}
                                                        value={StandardEmailTemplate}
                                                        onchange={handleEmailTemplateOnChange}                                            
                                                        >
                                                        </lightning-combobox>                                                             
                                                    </td>
                                                </tr>
                                                
                                                <tr>
                                                    <td style="width:180px;">
                                                        Junodoc Email Template:
                                                    </td>
                                                    <td>
                                                        <lightning-combobox 
                                                        name="JunoDocEmailTemplates" 
                                                        options={JunoDocEmailTemplatesList}
                                                        value={JunoDocEmailTemplate}
                                                        onchange={handleEmailTemplateOnChange}
                                                        >
                                                        </lightning-combobox>                                                             
                                                    </td>
                                                </tr>
                                                <tr style="height: 10px;"></tr>
                                                <tr style="height: 10px;">
                                                    <td style="width:180px;">
                                                        Enter Subject:
                                                    </td>
                                                    <td>                                                  
                                                    <lightning-input type="text" label="" value={subject}></lightning-input>                                                    
                                                    </td>
                                                    </tr>
                                                    <tr style="height: 10px;"></tr>
                                                <tr style="height: 10px;">
                                                        <td style="width:180px;">
                                                            Enter Body:
                                                        </td>
                                                    <td>
                                                         <lightning-input-rich-text value={body}></lightning-input-rich-text>
                                                  </td>                                                   
                                                </tr>
    
                                               <!-- <tr style="height: 20px;">
                                                    <td style="width:180px;">
                                                        Save as Activity:
                                                    </td>
                                                    <td>
                                                        <lightning-input data-field="SaveAsActivity" 
                                                        name="EmailSubject" 
                                                        type="checkbox" 
                                                        checked={SaveAsActivity} 
                                                        onchange={handleSaveAsActivityOnChange}
                                                        ></lightning-input>
                                                    </td>
                                                </tr> -->

                                                </tbody>
                                            </table>
                                        </lightning-accordion-section>
                                 </lightning-accordion>
                                 <div class="slds-clearfix" style="padding-right:10px;">
                                    <lightning-button variant="brand" label="Send" title="Primary action" onclick={SendPDFHelper} class="slds-float_right slds-m-left_x-small"></lightning-button>
                                 <lightning-button variant="Neutral" label="Cancel" title="Primary action" onclick={openForthScreen} class="slds-float_right slds-m-left_x-small"></lightning-button>

                                 </div>
                                 
                                 </div>  
             <!--   <iframe height="800px" width="100%" src={sendDocURL}></iframe>  -->
            </template>
       </template>
       <br/>
    </div>
    </lightning-card>
    </template>